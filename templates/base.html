<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="UTF-8" />
  <title>{% block title %}Edrelax Beach | Edremitâ€™te Åezlong Keyfi{% endblock %}</title>
  <link
      rel="icon"
      type="image/x-icon"
      href="{{ url_for('static', filename='images/favicon.ico') }}"
  />
  <meta name="csrf-token" content="{{ csrf_token }}" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  {# ğŸ”½ SEO & Sosyal Medya Meta Tag BloklarÄ± - override edilebilir #}
  {% block meta %}
  <meta name="description" content="Edrelax Beach ile Edremit sahilinde online ÅŸezlong ve gÃ¼ndelik rezervasyonu yapÄ±n. Tatilinizi Ã¶nceden planlayÄ±n, rahatlÄ±ÄŸÄ±n tadÄ±nÄ± Ã§Ä±karÄ±n.">
  <link rel="canonical" href="https://www.edrelaxbeach.com/" />

  <!-- Open Graph -->
  <meta property="og:title" content="Edrelax Beach | Edremitâ€™te Åezlong Keyfi">
  <meta property="og:description" content="Online ÅŸezlong ve gÃ¼ndelik kiralama. Edremit sahilinde rahat ve hÄ±zlÄ± rezervasyon.">
  <meta property="og:image" content="https://www.edrelaxbeach.com/static/images/og-banner.webp">
  <meta property="og:url" content="https://www.edrelaxbeach.com/" />
  <meta property="og:type" content="website" />

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Edrelax Beach | Edremitâ€™te Åezlong Keyfi" />
  <meta name="twitter:description" content="Åezlong ve gÃ¼ndelik rezervasyonunuzu kolayca yapÄ±n. Edrelax Beach ile konforlu bir sahil deneyimi yaÅŸayÄ±n.">
  <meta name="twitter:image" content="https://www.edrelaxbeach.com/static/images/og-banner.webp" />
  {% endblock %}

  <!-- ğŸŒ CSS DosyalarÄ± -->
  <link
    rel="stylesheet"
    href="{{ url_for('static', filename='css/style.css') }}?v={{ cache_buster('css/style.css') }}"
  />
  <link
    rel="stylesheet"
    href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
  />

  <!-- âœ¨ Fancy Font for Logo -->
  <link
    href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
    rel="stylesheet"
  />
</head>

  <body class="{% block body_class %}{% endblock %}">
    <div class="menu-overlay"></div>
    <!-- ğŸ” Navbar -->
    <header class="top-nav">
      <div class="nav-section left">
        <a href="{{ url_for('public.index') }}" class="logo">
          <img
            src="{{ url_for('static', filename='images/logo_edrelax.png') }}"
            alt="Edrelax Logo"
            style="
              height: 42px;
              vertical-align: middle;
              filter: drop-shadow(0 0 2px rgba(0, 0, 0, 0.2));
            "
          />
        </a>
      </div>

      <!-- Hamburger MenÃ¼ (Mobil) -->
      <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation">
        <i class="fas fa-bars"></i>
      </button>

      <div class="nav-links" id="nav-links">
        {% if current_user.is_authenticated and current_user.role == 'beach_admin' %}
          <a href="{{ url_for('auth.profile') }}">ğŸ‘¤ Profil</a>
          <a href="{{ url_for('beach_admin.dashboard') }}" class="{% if request.path == url_for('beach_admin.dashboard') %}active{% endif %}">
            ğŸ–ï¸ Plaj Paneli
          </a>
          <a href="{{ url_for('beach_admin.reservations') }}" class="{% if request.path == url_for('beach_admin.reservations') %}active{% endif %}">
            ğŸ“… Rezervasyonlar
          </a>
          <a href="{{ url_for('beach_admin.manage_items') }}" class="{% if request.path == url_for('beach_admin.manage_items') %}active{% endif %}">
            ğŸ›ï¸ Åezlonglar
          </a>
          <a href="{{ url_for('beach_admin.bed_occupancy') }}" class="{% if request.path == url_for('beach_admin.bed_occupancy') %}active{% endif %}">
            ğŸ“Š Doluluk
          </a>

          {% if session.get('beach_id') %}
            <a href="{{ url_for('beach_admin.bed_schedule', beach_id=session.get('beach_id')) }}" class="{% if request.path == url_for('beach_admin.bed_schedule', beach_id=session.get('beach_id')) %}active{% endif %}">
              â° Saatlik Doluluk
            </a>
          {% endif %}

          <span style="margin: 0 10px">
            ğŸ‘‹ Merhaba, <strong>{{ current_user.first_name }}</strong>
          </span>
          <a href="{{ url_for('auth.logout') }}" id="logout-link-admin">Ã‡Ä±kÄ±ÅŸ Yap</a>

        {% elif current_user.is_authenticated %}
          <a href="{{ url_for('public.beach_application') }}" class="btn-add-beach">PlajÄ±nÄ± Ekle</a>
          <a href="{{ url_for('public.about') }}?tab=help">YardÄ±m</a>
          <a href="{{ url_for('public.contact') }}">Ä°letiÅŸim</a>
          <a href="{{ url_for('auth.profile') }}">Profil</a>
          <a href="{{ url_for('public.my_favorites') }}">â­ Favorilerim</a>

          {% if current_user.email in admin_emails %}
            <a href="{{ url_for('admin.beaches') }}">YÃ¶netim Paneli</a>
            <a href="{{ url_for('admin.manage_users') }}">KullanÄ±cÄ±lar</a>
            <a href="{{ url_for('admin.dashboard') }}">Ä°statistikler</a>
          {% else %}
            <a href="{{ url_for('reservations.my_reservations') }}">RezervasyonlarÄ±m</a>
            <a href="{{ url_for('public.kredi') }}" class="balance-box" title="Kredi Bilgisi">
              ğŸ’° {{ session.get('user_credit', 0) }} TL
            </a>
          {% endif %}

          <span style="margin: 0 10px">
            ğŸ‘‹ HoÅŸ geldin, <strong>{{ current_user.first_name }}</strong>
          </span>
          <a href="{{ url_for('auth.logout') }}" id="logout-link-user">Ã‡Ä±kÄ±ÅŸ Yap</a>

        {% else %}
          {# Misafir KullanÄ±cÄ± (giriÅŸ yapmamÄ±ÅŸ) #}
          <a href="{{ url_for('public.beach_application') }}" class="btn-add-beach">PlajÄ±nÄ± Ekle</a>
          <a href="{{ url_for('public.about') }}?tab=help">YardÄ±m</a>
          <a href="{{ url_for('public.contact') }}">Ä°letiÅŸim</a>
          <a href="{{ url_for('auth.signup') }}">KayÄ±t Ol</a>
          <a href="{{ url_for('auth.login') }}">GiriÅŸ Yap</a>
        {% endif %}
      </div>
    </header>

    <!-- ğŸ” YÃ¼kleme ekranÄ± -->
    <div id="loader">
      <div class="spinner"></div>
    </div>

    <!-- âœ… GerÃ§ek iÃ§erik buraya yÃ¼klenecek -->
    <div id="main-content" style="display: none">
      <!-- ğŸ“„ Sayfa iÃ§eriÄŸi -->
      <main class="container mt-4 mb-5">
        {% with messages = get_flashed_messages(with_categories=true) %} {% if
        messages %} {% for category, message in messages %}
        <div
          class="alert alert-{{ category }} alert-dismissible fade show"
          role="alert"
        >
          {{ message }}
          <button
            type="button"
            class="close"
            data-dismiss="alert"
            aria-label="Close"
          >
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        {% endfor %} {% endif %} {% endwith %} {% block content %}{% endblock %}
      </main>
    </div>

    <!-- ğŸ‘£ Footer -->
    {% include 'footer.html' %}

    <!-- ğŸ“œ JavaScript -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- ğŸ” Sayfa yÃ¼klenince loader'Ä± kapat -->
    <script>
      function hideLoader() {
        const loader = document.getElementById("loader");
        if (loader) loader.style.display = "none";

        const content = document.getElementById("main-content");
        if (content) content.style.display = "block";
      }

      // Sayfa normal yÃ¼klendiÄŸinde
      window.addEventListener("load", hideLoader);

      // Sayfa geri gelince (back/forward)
      window.addEventListener("pageshow", hideLoader);
    </script>

    <!-- ğŸŒ Hamburger Toggle Script -->
    <script>
      // SayfanÄ±n tÃ¼m HTML iÃ§eriÄŸi yÃ¼klendikten sonra bu kodun Ã§alÄ±ÅŸmasÄ±nÄ± bekle.
      // Bu, script'in aradÄ±ÄŸÄ± elementleri bulamama riskini ortadan kaldÄ±rÄ±r.
      document.addEventListener("DOMContentLoaded", function () {
        // Gerekli HTML elementlerini class isimleriyle seÃ§
        const navToggle = document.querySelector(".nav-toggle");
        const navLinks = document.querySelector(".nav-links");
        const menuOverlay = document.querySelector(".menu-overlay");
        const body = document.body;

        // Elementlerin sayfada bulunduÄŸundan emin ol (hata almamak iÃ§in)
        if (navToggle && navLinks && menuOverlay) {
          // MenÃ¼yÃ¼ kapatmak iÃ§in tekrar kullanÄ±labilir bir fonksiyon
          function closeMenu() {
            navLinks.classList.remove("active");
            menuOverlay.classList.remove("active");
            body.classList.remove("no-scroll");
          }

          // Hamburger menÃ¼ ikonuna tÄ±klandÄ±ÄŸÄ±nda...
          navToggle.addEventListener("click", (event) => {
            event.stopPropagation(); // OlayÄ±n daha fazla yayÄ±lmasÄ±nÄ± engelle

            // Ä°lgili tÃ¼m elementlere "active" class'Ä±nÄ± ekle/kaldÄ±r
            navLinks.classList.toggle("active");
            menuOverlay.classList.toggle("active");
            body.classList.toggle("no-scroll"); // Arka plan kaymasÄ±nÄ± engelle
          });

          // Arka plan karartÄ±sÄ±na (overlay) tÄ±klandÄ±ÄŸÄ±nda menÃ¼yÃ¼ kapat
          menuOverlay.addEventListener("click", closeMenu);
          window.addEventListener('resize', () => {
              // EÄŸer ekran 768 pikselden daha geniÅŸse (masaÃ¼stÃ¼ gÃ¶rÃ¼nÃ¼mÃ¼)
              if (window.innerWidth > 768) {
                  // MenÃ¼ aÃ§Ä±ksa, kapat ve stilleri sÄ±fÄ±rla
                  if (navLinks.classList.contains('active')) {
                      closeMenu();
                  }
              }
          });
        }
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const forms = document.querySelectorAll("form");
        forms.forEach((form) => {
          form.addEventListener("submit", function () {
            const loader = document.getElementById("loader");
            if (loader) loader.style.display = "flex";
          });
        });
      });
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Her iki logout linkini de seÃ§iyoruz
        const logoutLinkAdmin = document.getElementById("logout-link-admin");
        const logoutLinkUser = document.getElementById("logout-link-user");

        // TÄ±klama olayÄ±nÄ± dinleyecek bir fonksiyon
        function handleLogoutClick(event) {
          // Normal link davranÄ±ÅŸÄ±nÄ± engelle
          event.preventDefault();
          
          // YÃ¼kleme ekranÄ±nÄ± gÃ¶ster
          const loader = document.getElementById("loader");
          if (loader) loader.style.display = "flex";

          // TarayÄ±cÄ±yÄ± logout URL'ine manuel olarak yÃ¶nlendir.
          // Bu, Ã¶nbelleÄŸi atlayÄ±p sayfanÄ±n taze olarak yÃ¼klenmesini saÄŸlar.
          window.location.href = this.href;
        }

        // EÄŸer linkler sayfada varsa, tÄ±klama olayÄ±nÄ± ata
        if (logoutLinkAdmin) {
          logoutLinkAdmin.addEventListener("click", handleLogoutClick);
        }
        if (logoutLinkUser) {
          logoutLinkUser.addEventListener("click", handleLogoutClick);
        }
      });
    </script>
  </body>
</html>
